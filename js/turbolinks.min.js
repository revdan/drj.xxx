!function(){var t,e,n,i,o,r,a,s,l,c,d,u,h,p,f,m,g,v,y,b,_,w,x,$,C,A,k,T,j,S,D,M,O,I,E,N,B,P,F,L,R,H,W,z,U,q,Y={}.hasOwnProperty,K=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};_=!1,d=null,S=document.location.href,$=null,T={},l=null,P=(null!=(U=document.cookie.match(/request_method=(\w+)/))?U[1].toUpperCase():void 0)||"",z=null,W=function(t){return o?(r(),D(t),g(t)):document.location.href=t},g=function(t){var n;return H("page:fetch"),n=N(t),null!=z&&z.abort(),z=new XMLHttpRequest,z.open("GET",n,!0),z.setRequestHeader("Accept","text/html, application/xhtml+xml, application/xml"),z.setRequestHeader("X-XHR-Referer",S),z.onload=function(){var t;return t=l(z.responseText),e(t)?document.location.reload():(a.apply(null,p(t)),M(z),document.location.hash?document.location.href=document.location.href:L(),H("page:load"))},z.onloadend=function(){return z=null},z.onabort=function(){return I()},z.onerror=function(){return document.location.href=t},z.send()},m=function(t){var e;return r(),(e=T[t.position])?(null!=z&&z.abort(),a(e.title,e.body),j(e),H("page:restore")):g(document.location.href)},r=function(){return E(),T[d.position]={url:document.location.href,body:document.body,title:document.title,positionY:window.pageYOffset,positionX:window.pageXOffset},s(10)},s=function(t){var e,n,i;i=[];for(e in T)Y.call(T,e)&&(n=T[e],e<=d.position-t?i.push(T[e]=null):i.push(void 0));return i},a=function(t,e,n){return document.title=t,document.documentElement.replaceChild(e,document.body),B(),n&&u(),d=window.history.state,H("page:change")},u=function(){var t,e,n,i,o,r,a,s,l,c,d,u,h;for(r=Array.prototype.slice.call(document.body.getElementsByTagName("script")),h=[],a=0,l=r.length;l>a;a++)if(o=r[a],""===(d=o.type)||"text/javascript"===d){for(e=document.createElement("script"),u=o.attributes,s=0,c=u.length;c>s;s++)t=u[s],e.setAttribute(t.name,t.value);e.appendChild(document.createTextNode(o.innerHTML)),i=o.parentNode,n=o.nextSibling,i.removeChild(o),h.push(i.insertBefore(e,n))}return h},B=function(){var t,e,n,i,o;for(e=Array.prototype.slice.call(document.body.getElementsByTagName("noscript")),o=[],n=0,i=e.length;i>n;n++)t=e[n],o.push(t.parentNode.removeChild(t));return o},D=function(t){return t!==document.location.href?(S=document.location.href,window.history.pushState({turbolinks:!0,position:d.position+1},"",t)):void 0},M=function(t){var e;return(e=t.getResponseHeader("X-XHR-Current-Location"))&&e!==document.location.pathname+document.location.search?window.history.replaceState(d,"",e+document.location.hash):void 0},I=function(){return window.history.replaceState({turbolinks:!0,position:Date.now()},"",document.location.href)},O=function(){return d=window.history.state},E=function(){return _?void 0:(I(),O(),l=n(),_=!0)},j=function(t){return window.scrollTo(t.positionX,t.positionY)},L=function(){return window.scrollTo(0,0)},N=function(t){var e;return e=t,null==t.href&&(e=document.createElement("A"),e.href=t),e.href.replace(e.hash,"")},H=function(t){var e;return e=document.createEvent("Events"),e.initEvent(t,!0,!0),document.dispatchEvent(e)},f=function(t){var e,n,i,o,r;for(o=t.head.childNodes,r=[],n=0,i=o.length;i>n;n++)e=o[n],null!=("function"==typeof e.getAttribute?e.getAttribute("data-turbolinks-track"):void 0)&&r.push(e.src||e.href);return r},e=function(t){var e;return $||($=f(document)),e=f(t),e.length!==$.length||x(e,$).length!==$.length},x=function(t,e){var n,i,o,r,a;for(t.length>e.length&&(r=[e,t],t=r[0],e=r[1]),a=[],i=0,o=t.length;o>i;i++)n=t[i],K.call(e,n)>=0&&a.push(n);return a},p=function(t){var e;return e=t.querySelector("title"),[null!=e?e.textContent:void 0,t.body,"runScripts"]},n=function(){var t,e,n,i,o;e=function(t){return(new DOMParser).parseFromString(t,"text/html")},t=function(t){var e;return e=document.implementation.createHTMLDocument(""),e.documentElement.innerHTML=t,e},n=function(t){var e;return e=document.implementation.createHTMLDocument(""),e.open("replace"),e.write(t),e.close(),e};try{if(window.DOMParser)return i=e("<html><body><p>test"),e}catch(r){return i=t("<html><body><p>test"),t}finally{if(1!==(null!=i?null!=(o=i.body)?o.childNodes.length:void 0:void 0))return n}},w=function(t){return t.defaultPrevented?void 0:(document.removeEventListener("click",v),document.addEventListener("click",v))},v=function(t){var e;return t.defaultPrevented||(e=h(t),"A"!==e.nodeName||y(t,e))?void 0:(W(e.href),t.preventDefault())},h=function(t){var e;for(e=t.target;e.parentNode&&"A"!==e.nodeName;)e=e.parentNode;return e},c=function(t){return location.protocol!==t.protocol||location.host!==t.host},t=function(t){return(t.hash&&N(t))===N(location)||t.href===location.href+"#"},A=function(t){return t.href.match(/\.[a-z]+(\?.*)?$/g)&&!t.href.match(/\.html?(\?.*)?$/g)},C=function(t){for(var e;!e&&t!==document;)e=null!=t.getAttribute("data-no-turbolink"),t=t.parentNode;return e},R=function(t){return 0!==t.target.length},k=function(t){return t.which>1||t.metaKey||t.ctrlKey||t.shiftKey||t.altKey},y=function(e,n){return c(n)||t(n)||A(n)||C(n)||R(n)||k(e)},b=function(){return document.addEventListener("click",w,!0),window.addEventListener("popstate",function(t){var e;return(null!=(e=t.state)?e.turbolinks:void 0)?m(t.state):void 0})},o=window.history&&window.history.pushState&&window.history.replaceState&&void 0!==window.history.state,i=!navigator.userAgent.match(/CriOS\//),F="GET"===P||""===P,o&&i&&F&&b(),this.Turbolinks={visit:W},(null!=(q=window.history)?q.pushState:void 0)&&window.history.replaceState&&document.addEventListener("page:change",function(){return void 0!==window._gaq?_gaq.push(["_trackPageview"]):void 0!==window.pageTracker?pageTracker._trackPageview():void 0})}.call(this);
